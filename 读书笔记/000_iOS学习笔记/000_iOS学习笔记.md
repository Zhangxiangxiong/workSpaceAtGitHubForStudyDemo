##000_iOS学习笔记
***
###2016年09月01日
1.使用代码提示定义*block*,

~~~
// type "inline"
~~~


2: *block* 和 *delegate* 的使用范例:

2.1 场景：

~~~
假设存在*ContractListVC* 和 *ContractAddVC*,当单击*ContractListVC*的**add** 按钮后,页面**push**到*ContractAddVC*。
用户在*ContractAddVC*输入完数据,单击**save** 按钮后,页面**pop**到*ContractListVC*。现在关注点是如何实现数据的逆向传输,即单击了save按钮后,如何触发上一个页面执行代码。
~~~

2.2 使用 *delegate* 的实现机制:

~~~
1：在ContractAddVC 中定义代理，并用之前的代理声明成员对象。
2：在ContractListVC 中声明遵守在第一步中定义的代理。并实现该代理。
3：在ContractListVC跳转前,在找到目标vc实例,并将目标vc的delegate赋值为self。
4：在ContractAddVC中使用delegate 触发代码。
~~~

2.3 使用 *block* 的实现机制:

~~~
//1:在ContractAddVC完成代理的定义和成员变量的声明
// block的定义
typedef void (^ContractAddBlock)(void);

@interface ContactAddViewController : UIViewController

// block成员变量的声明
@property(nonatomic,assign)ContractAddBlock addBlock;

@end

~~~

~~~
//2:在ContractAddVC在合适的使用使用代理,注意防卫型代码,判断block是否为nil

// 当单击保存按钮
- (IBAction)onSaveClick:(id)sender
{
    if(_addBlock != nil)
    {
        _addBlock();
    }
    
    [self.navigationController popViewControllerAnimated:YES];
}

~~~


~~~objc
//2:在ContractListVC完成代理的赋值,实现逆传功能(代码回调)。
// 当单击保存按钮

-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if([segue.identifier isEqualToString:@"addSegue"])
    {
        ContactAddViewController *destVC = segue.destinationViewController;
        
        //(代码回调)
        destVC.addBlock = ^(void)
        {
            NSLog(@"当ContractAddVC执行了保存操作,此处应该刷新tableview");
        };
    }
}
~~~


###2016年09月03日
####1. 打电话代码
~~~objc

1，这种方法，拨打完*****回不到原来的应用，会停留在通讯录里，而且是直接拨打，不弹出提示
 NSMutableString * str=[[NSMutableString alloc] initWithFormat:@"tel:%@",@"186xxxx6979"];
    //            NSLog(@"str======%@",str);
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:str]];
    
2，这种方法，打完*****后还会回到原来的程序，也会弹出提示，推荐这种
NSMutableString * str=[[NSMutableString alloc] initWithFormat:@"tel:%@",@"186xxxx6979"];
    UIWebView * callWebview = [[UIWebView alloc] init];
    [callWebview loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:str]]];
    [self.view addSubview:callWebview];
    [callWebview release];
    [str release];
    
~~~

####2. 振动提示
~~~objc
// first 
@import AudioToolbox;
// second
AudioServicesPlaySystemSound(kSystemSoundID_Vibrate);


~~~


####3. URL Scheme 的作用
在iOS中有系统特定的 URL Scheme。比如打电话的scheme 是 tel:.
打开设置页面的scheme 是"prefs:root=AIRPLANE_MODE"

~~~objc

[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"prefs:root=AIRPLANE_MODE"]];

~~~

####3.1 如何自定义自己的 sheme？

1. 首先在info.plist 文件中注册 scheme。

1.1
![custom sheme](./images/custom sheme 01.png)
1.2
![custom sheme](./images/custom sheme 02.png)



~~~objc 
// 其他app通过    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"cityguide://London"]]; 唤醒
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {


    // 第三方通过 sheme唤醒 注意检测UIApplicationLaunchOptionsURLKey
    NSLog(@"launchOptions:%@", launchOptions);
    
    if([launchOptions objectForKey:UIApplicationLaunchOptionsURLKey] != nil)
    {
        NSURL* url = launchOptions[UIApplicationLaunchOptionsURLKey];
    }
    return YES;
}

// 如果app在后台运行时,被第三方通过sheme唤醒。 和之前didFinishLaunchingWithOptions 一样处理
-(BOOL)application:(UIApplication *)app openURL:(NSURL *)url options:(NSDictionary<NSString *,id> *)options
{
    return YES;
}

~~~
